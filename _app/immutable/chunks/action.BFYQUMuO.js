import{d as m,w as x,g as y}from"./paths.BemCS2IU.js";import{s as I,w,c as v,u as T}from"./action.T8_0rnP9.js";import{n as C,d as i,w as A,o as F,u as O,p as S}from"./utils.u9wr4E9e.js";import{u as L}from"./index.B5KMVwHN.js";import{u as M}from"./events.DPoVpqpP.js";function B(e){e.setAttribute("data-highlighted","")}function G(e){e.removeAttribute("data-highlighted")}function k(e,n=500){let t=null;return function(...s){const r=()=>{t=null,e(...s)};t&&clearTimeout(t),t=setTimeout(r,n)}}function W(e){const{open:n,forceVisible:t,activeTrigger:s}=e;return m([n,t,s],([r,a,c])=>(r||a)&&c!==null)}function K(e){C&&I(1).then(()=>{const n=document.activeElement;!i(n)||n===e||(n.tabIndex=-1,e&&(e.tabIndex=0,e.focus()))})}function p(){return Array.from(document.querySelectorAll('a[href]:not([tabindex="-1"]), button:not([disabled]):not([tabindex="-1"]), input:not([disabled]):not([tabindex="-1"]), select:not([disabled]):not([tabindex="-1"]), textarea:not([disabled]):not([tabindex="-1"]), [tabindex]:not([tabindex="-1"])'))}function $(e){const n=p(),s=n.indexOf(e)+1,r=n[s];return s<n.length&&i(r)?r:null}function J(e){const n=p(),s=n.indexOf(e)-1,r=n[s];return s>=0&&i(r)?r:null}const P=new Set(["Shift","Control","Alt","Meta","CapsLock","NumLock"]),D={onMatch:K,getCurrentItem:()=>document.activeElement};function Q(e={}){const n={...D,...e},t=A(x([])),s=k(()=>{t.update(()=>[])});return{typed:t,resetTyped:s,handleTypeaheadSearch:(a,c)=>{if(P.has(a))return;const d=n.getCurrentItem(),o=y(t);if(!Array.isArray(o))return;o.push(a.toLowerCase()),t.set(o);const h=c.filter(u=>!(u.getAttribute("disabled")==="true"||u.getAttribute("aria-disabled")==="true"||u.hasAttribute("data-disabled"))),b=o.length>1&&o.every(u=>u===o[0])?o[0]:o.join(""),g=i(d)?h.indexOf(d):-1;let l=w(h,Math.max(g,0));b.length===1&&(l=l.filter(u=>u!==d));const f=l.find(u=>(u==null?void 0:u.innerText)&&u.innerText.toLowerCase().startsWith(b.toLowerCase()));i(f)&&f!==d&&n.onMatch(f),s()}}}const H={floating:{},focusTrap:{},modal:{},escapeKeydown:{},portal:"body"},U=(e,n)=>{e.dataset.escapee="";const{anchorElement:t,open:s,options:r}=n;if(!t||!s||!r)return{destroy:F};const a={...H,...r},c=[];if(a.portal!==null&&c.push(M(e,a.portal).destroy),c.push(L(t,e,a.floating).destroy),a.focusTrap!==null){const{useFocusTrap:o}=v({immediate:!0,escapeDeactivates:!1,allowOutsideClick:!0,returnFocusOnDeactivate:!1,fallbackFocus:e,...a.focusTrap});c.push(o(e).destroy)}a.modal!==null&&c.push(T(e,{onClose:()=>{i(t)&&(s.set(!1),t.focus())},shouldCloseOnInteractOutside:o=>!(o.defaultPrevented||i(t)&&t.contains(o.target)),...a.modal}).destroy),a.escapeKeydown!==null&&c.push(O(e,{enabled:s,handler:()=>{s.set(!1)},...a.escapeKeydown}).destroy);const d=S(...c);return{destroy(){d()}}};export{J as a,B as b,Q as c,W as d,$ as g,K as h,G as r,U as u};
